<h3>Scroll_To_TaskRow</h3>

@page "/Gantt/Scrolling/Scroll_To_TaskRow"
@rendermode InteractiveServer

@using Syncfusion.Blazor.Gantt
@using Syncfusion.Blazor.Inputs
@using Syncfusion.Blazor.Buttons

<div style="display: flex; gap: 15px; margin-bottom: 20px;">
    <!-- Scroll Position -->
    <div>
        <label style="font-weight:20px" for="columnIndex">Scroll Row:</label>
        <div style="display: flex; align-items: center; gap: 10px; margin-top: 5px;">
            <SfTextBox @bind-Value="ColumnIndex" Placeholder="Column Index (e.g., 1)" Width="160px" />
            <SfTextBox @bind-Value="RowIndex" Placeholder="Row Index (e.g., 1)" Width="150px" />
            <SfButton OnClick="SelectRow">Scroll Position</SfButton>
        </div>
    </div>
    <!-- Scroll to Date -->
    <div>
        <label style="font-weight:20px" for="scrollDate">Scroll to Timeline Date:</label>
        <div style="display: flex; align-items: center; gap: 10px; margin-top: 5px;">
            <SfTextBox @bind-Value="ScrollDate" Placeholder="MM/DD/YYYY" Width="150px" />
            <SfButton OnClick="ScrollToDate">Scroll Date</SfButton>
        </div>
    </div>

    <!-- Scroll to Task -->
    <div>
        <label style="font-weight:20px" for="taskId">Scroll to Task:</label>
        <div style="display: flex; align-items: center; gap: 10px; margin-top: 5px;">
            <SfTextBox @bind-Value="ScrollTaskId" Placeholder="e.g., 3" Width="150px" />
            <SfButton OnClick="ScrollToTask">Scroll Task</SfButton>
        </div>
    </div>
</div>

<SfGantt @ref="GanttInstance" ID="Gantt" DataSource="@TaskCollection" Height="350px" Width="100%">
    <GanttTaskFields Id="ProjectId" Name="ProjectName" StartDate="ProjectStartDate" EndDate="ProjectEndDate" Duration="ProjectDuration" Progress="ProjectProgress" Dependency="Predecessor" ParentID="ParentID" />
    <GanttColumns>
        <GanttColumn Field="ProjectId" HeaderText="Task ID" />
        <GanttColumn Field="ProjectName" HeaderText="Task Name" />
        <GanttColumn Field="ProjectStartDate" HeaderText="Start Date" />
        <GanttColumn Field="ProjectEndDate" HeaderText="End Date" />
        <GanttColumn Field="ProjectDuration" HeaderText="Duration" />
        <GanttColumn Field="Field1" HeaderText="Rebounds" />
        <GanttColumn Field="FIELD2" HeaderText="Year" />
        <GanttColumn Field="FIELD3" HeaderText="Stint" />
        <GanttColumn Field="FIELD4" HeaderText="TMID" />
        <GanttColumn Field="FIELD5" HeaderText="LGID" />
        <GanttColumn Field="FIELD6" HeaderText="GP" />
        <GanttColumn Field="Field7" HeaderText="GS" />
        <GanttColumn Field="Field8" HeaderText="Minutes" />
        <GanttColumn Field="Field9" HeaderText="Points" />
        <GanttColumn Field="Field10" HeaderText="ORebounds" />
        <GanttColumn Field="Field11" HeaderText="DRebounds" />
    </GanttColumns>
</SfGantt>

@code {
    public SfGantt<TaskData> GanttInstance;
    public List<TaskData> TaskCollection { get; set; } = new();
    public string RowIndex { get; set; }
    public string ScrollDate { get; set; }
    public string ScrollTaskId { get; set; }
    public string ColumnIndex { get; set; }

    protected override void OnInitialized()
    {
        TaskCollection = VirtualData.GetTreeVirtualData();
    }

    public async Task SelectRow()
    {
        if (int.TryParse(RowIndex, out var rowIndex) && int.TryParse(ColumnIndex, out var columnIndex))
        {
            await this.GanttInstance.SelectRowAsync(rowIndex);
            await this.GanttInstance.ScrollIntoViewAsync(columnIndex, rowIndex);
        }
    }


    public async Task ScrollToDate()
    {
        if (DateTime.TryParse(ScrollDate, out var date))
        {
            await this.GanttInstance.ScrollToTimelineAsync(date);
        }
    }

    public async Task ScrollToTask()
    {
        if (int.TryParse(ScrollTaskId, out var taskId))
        {
            await this.GanttInstance.ScrollToTaskbarAsync(taskId);
        }
    }

    public class VirtualData
    {
        public static List<TaskData> GetTreeVirtualData()
        {
            string[] Names = new string[] { "VINET", "TOMSP", "HANAR", "VICTE", "SUPRD" };
            List<TaskData> DataCollection = new();
            int x = 0;
            for (int i = 1; i <= 10; i++)
            {
                var parent = new TaskData
                {
                    ProjectId = ++x,
                    ProjectName = "Task " + x,
                    ProjectStartDate = new DateTime(2022, 1, 9),
                    ProjectEndDate = new DateTime(2022, 1, 13),
                    ProjectDuration = "10",
                    ProjectProgress = x + 20,
                    ParentID = null,
                    Predecessor = null,
                };
                DataCollection.Add(parent);

                for (int j = 1; j <= 5; j++)
                {
                    DataCollection.Add(new TaskData
                    {
                        ProjectId = ++x,
                        ProjectName = "Task " + x,
                        ProjectStartDate = new DateTime(2022, 1, 9),
                        ProjectEndDate = new DateTime(2022, 1, 13),
                        ProjectDuration = "10",
                        ProjectProgress = x + 20,
                        ParentID = parent.ProjectId,
                        Predecessor = i + "FS",
                        Field1 = Names[x % Names.Length],
                        FIELD2 = 1967 + x,
                        FIELD3 = 395 + x,
                        FIELD4 = 87 + x,
                        FIELD5 = 410 + x,
                        FIELD6 = 67 + x,
                        Field7 = x * 100,
                        Field8 = x * 10,
                        Field9 = x * 10,
                        Field10 = x * 100,
                        Field11 = x * 100,
                        Field12 = x * 1000,
                    });
                }
            }
            return DataCollection;
        }
    }

    public class TaskData
    {
        public int ProjectId { get; set; }
        public string ProjectName { get; set; }
        public DateTime? ProjectStartDate { get; set; }
        public DateTime? ProjectEndDate { get; set; }
        public string ProjectDuration { get; set; }
        public int ProjectProgress { get; set; }
        public int? ParentID { get; set; }
        public string Predecessor { get; set; }
        public string Field1 { get; set; }
        public int FIELD2 { get; set; }
        public int FIELD3 { get; set; }
        public int FIELD4 { get; set; }
        public int FIELD5 { get; set; }
        public int FIELD6 { get; set; }
        public int Field7 { get; set; }
        public int Field8 { get; set; }
        public int Field9 { get; set; }
        public int Field10 { get; set; }
        public int Field11 { get; set; }
        public int Field12 { get; set; }
    }
}
