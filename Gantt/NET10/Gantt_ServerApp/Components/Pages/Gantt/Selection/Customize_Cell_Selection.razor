<h3>Customize_Cell_Selection</h3>

@page "/Gantt/Selection/Customize_Cell_Selection"
@rendermode InteractiveServer

@using Syncfusion.Blazor.Gantt
@using Syncfusion.Blazor.Grids

@if (showMessage)
{
    <div style="margin-top:10px; font-weight:bold;color:red">@message</div>
}
<SfGantt DataSource="@TaskCollection" Height="450px" Width="700px">
    <GanttTaskFields Id="TaskID" Name="TaskName" StartDate="StartDate" EndDate="EndDate" Duration="Duration" Progress="Progress" ParentID="ParentID">
    </GanttTaskFields>
    <GanttSelectionSettings Mode="Syncfusion.Blazor.Grids.SelectionMode.Cell" Type="Syncfusion.Blazor.Grids.SelectionType.Multiple"></GanttSelectionSettings>
    <GanttEvents TValue="TaskData" CellSelecting="CellSelectingAsync" CellSelected="CellSelectedAsync" CellDeselecting="CellDeselectingAsync" CellDeselected="CellDeselectedAsync">
    </GanttEvents>
</SfGantt>

@code {
    private List<TaskData> TaskCollection { get; set; }
    private string message;
    private bool showMessage;

    protected override void OnInitialized()
    {
        TaskCollection = GetTaskCollection();
    }

    public Task CellSelectedAsync(CellSelectEventArgs<TaskData> args)
    {
        showMessage = true;
        message = $"CellSelected: RowIndex={args.RowIndex}, CellIndex={args.CellIndex}";
        return Task.CompletedTask;
    }

    public Task CellSelectingAsync(CellSelectingEventArgs<TaskData> args)
    {
        showMessage = true;
        message = $"CellSelecting: RowIndex={args.RowIndex}, CellIndex={args.CellIndex}";

        if (args.Data?.TaskName == "Perform soil test")
        {
            args.Cancel = true;
            message += " Selection canceled for 'Perform soil test'";
        }

        return Task.CompletedTask;
    }

    public Task CellDeselectingAsync(CellDeselectEventArgs<TaskData> args)
    {
        showMessage = true;
        message = $"CellDeselecting: RowIndex={args.RowIndex}, CellIndex={args.CellIndex}";

        return Task.CompletedTask;
    }

    public Task CellDeselectedAsync(CellDeselectEventArgs<TaskData> args)
    {
        showMessage = true;
        message = $"CellDeselected: RowIndex={args.RowIndex}, CellIndex={args.CellIndex}";

        return Task.CompletedTask;
    }

    public class TaskData
    {
        public int TaskID { get; set; }
        public string TaskName { get; set; }
        public DateTime StartDate { get; set; }
        public DateTime? EndDate { get; set; }
        public string Duration { get; set; }
        public int Progress { get; set; }
        public int? ParentID { get; set; }
    }

    public static List<TaskData> GetTaskCollection()
    {
        return new List<TaskData>()
        {
            new TaskData() { TaskID = 1, TaskName = "Project initiation", StartDate = new DateTime(2022, 04, 05), EndDate = new DateTime(2022, 04, 08) },
            new TaskData() { TaskID = 2, TaskName = "Identify Site location", StartDate = new DateTime(2022, 04, 05), Duration = "0", Progress = 30, ParentID = 1 },
            new TaskData() { TaskID = 3, TaskName = "Perform soil test", StartDate = new DateTime(2022, 04, 05), Duration = "4", Progress = 40, ParentID = 1 },
            new TaskData() { TaskID = 4, TaskName = "Soil test approval", StartDate = new DateTime(2022, 04, 05), Duration = "0", Progress = 30, ParentID = 1 },
            new TaskData() { TaskID = 5, TaskName = "Project estimation", StartDate = new DateTime(2022, 04, 06), EndDate = new DateTime(2022, 04, 08) },
            new TaskData() { TaskID = 6, TaskName = "Develop floor plan for estimation", StartDate = new DateTime(2022, 04, 06), Duration = "3", Progress = 30, ParentID = 5 },
            new TaskData() { TaskID = 7, TaskName = "List materials", StartDate = new DateTime(2022, 04, 06), Duration = "3", Progress = 40, ParentID = 5 },
            new TaskData() { TaskID = 8, TaskName = "Estimation approval", StartDate = new DateTime(2022, 04, 06), Duration = "0", Progress = 30, ParentID = 5 }
        };
    }
}
